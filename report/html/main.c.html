
<html>
<head>
<title>main.c</title>
<link rel="stylesheet" type="text/css" href="./viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 #include &lt;stdio.h&gt;</div><div id="2" class="line none">    2 #include &lt;stdlib.h&gt;</div><div id="3" class="line none">    3 #include &lt;string.h&gt;</div><div id="4" class="line none">    4 #include &lt;assert.h&gt;</div><div id="5" class="line none">    5 #include "../include/constants.h"</div><div id="6" class="line none">    6 #include "../include/types.h"</div><div id="7" class="line none">    7 #include "../include/getters.h"</div><div id="8" class="line none">    8 #include "../include/printers.h"</div><div id="9" class="line none">    9 #include "../include/setters.h"</div><div id="10" class="line none">   10 #include "../include/payment.h"</div><div id="11" class="line none">   11 #include "../include/deposit.h"</div><div id="12" class="line none">   12 #include "../include/close.h"</div><div id="13" class="line none">   13 </div><div id="14" class="line none">   14 #include "../include/cbmc_helper.h"</div><div id="15" class="line none">   15 // #include "../include/mock_cbmc_helper.h"</div><div id="16" class="line none">   16 </div><div id="17" class="line none">   17 // Type for the contract template</div><div id="18" class="line none">   18 typedef struct {</div><div id="19" class="line none">   19     int <a href="main.c.html#19">amountAda</a>;</div><div id="20" class="line none">   20     int <a href="main.c.html#20">amountDollar</a>;</div><div id="21" class="line none">   21     int <a href="main.c.html#21">adaTimeout</a>;</div><div id="22" class="line none">   22     int <a href="main.c.html#22">dollarTimeout</a>;</div><div id="23" class="line none">   23 } <a href="main.c.html#23">ContractTemplate</a>;</div><div id="24" class="line none">   24 </div><div id="25" class="line none">   25 int <a href="main.c.html#25">main</a>() {</div><div id="26" class="line none">   26     // Define the tokens for internal accounts</div><div id="27" class="line none">   27     // int initialAda_AdaHolder_Internal = constr_non_det_int(0,0);</div><div id="28" class="line none">   28     // int initialDollar_AdaHolder_Internal = constr_non_det_int(0,0);</div><div id="29" class="line none">   29     // int initialAda_DollarHolder_Internal = constr_non_det_int(0,0);</div><div id="30" class="line none">   30     // int initialDollar_DollarHolder_Internal = constr_non_det_int(0,0);</div><div id="31" class="line none">   31     </div><div id="32" class="line hit">   32     int initialAda_AdaHolder_Internal = 0;</div><div id="33" class="line hit">   33     int initialDollar_AdaHolder_Internal = 0;</div><div id="34" class="line hit">   34     int initialAda_DollarHolder_Internal = 0;</div><div id="35" class="line hit">   35     int initialDollar_DollarHolder_Internal = 0;</div><div id="36" class="line none">   36     </div><div id="37" class="line hit">   37     Token adaAdaProviderInternal = {.currency = ADA, .amount = initialAda_AdaHolder_Internal};</div><div id="38" class="line hit">   38     Token dollarAdaProviderInternal = {.currency = DOLLAR, .amount = initialDollar_AdaHolder_Internal};</div><div id="39" class="line hit">   39     Token adaDollarProviderInternal = {.currency = ADA, .amount = initialAda_DollarHolder_Internal};</div><div id="40" class="line hit">   40     Token dollarDollarProviderInternal = {.currency = DOLLAR, .amount = initialDollar_DollarHolder_Internal};</div><div id="41" class="line none">   41 </div><div id="42" class="line none">   42     // Define the wallets for internal accounts</div><div id="43" class="line hit">   43     Token tokensAdaProviderInternal[] = {adaAdaProviderInternal, dollarAdaProviderInternal};</div><div id="44" class="line hit">   44     Wallet* walletAdaProviderInternal = <a href="setters.c.html#16">newWallet</a>(tokensAdaProviderInternal, 2);</div><div id="45" class="line hit">   45     Token tokensDollarProviderInternal[] = {adaDollarProviderInternal, dollarDollarProviderInternal};</div><div id="46" class="line hit">   46     Wallet* walletDollarProviderInternal = <a href="setters.c.html#16">newWallet</a>(tokensDollarProviderInternal, 2);</div><div id="47" class="line none">   47 </div><div id="48" class="line none">   48     // Define the internal accounts</div><div id="49" class="line hit">   49     InternalAccount accounts[] = {</div><div id="50" class="line hit">   50         {1, *walletAdaProviderInternal},</div><div id="51" class="line hit">   51         {2, *walletDollarProviderInternal}</div><div id="52" class="line none">   52     };</div><div id="53" class="line none">   53 </div><div id="54" class="line none">   54     // Define the internal wallet</div><div id="55" class="line hit">   55     InternalWallet* internalWallet = <a href="setters.c.html#42">newInternalWallet</a>(accounts, 2);</div><div id="56" class="line none">   56 </div><div id="57" class="line none">   57     // Define the tokens for external wallets</div><div id="58" class="line hit">   58     int initialAda_AdaHolder = <a href="cbmc_helper.c.html#1">constr_non_det_int</a>(0,100);</div><div id="59" class="line hit">   59     int initialDollar_AdaHolder = <a href="cbmc_helper.c.html#1">constr_non_det_int</a>(0,100);</div><div id="60" class="line hit">   60     int initialAda_DollarHolder = <a href="cbmc_helper.c.html#1">constr_non_det_int</a>(0,100);</div><div id="61" class="line hit">   61     int initialDollar_DollarHolder = <a href="cbmc_helper.c.html#1">constr_non_det_int</a>(0,100);</div><div id="62" class="line none">   62 </div><div id="63" class="line hit">   63     Token adaAdaProviderExternal = {.currency = ADA, .amount = initialAda_AdaHolder };</div><div id="64" class="line hit">   64     Token dollarAdaProviderExternal = {.currency = DOLLAR, .amount = initialDollar_AdaHolder};</div><div id="65" class="line hit">   65     Token adaDollarProviderExternal = {.currency = ADA, .amount = initialAda_DollarHolder};</div><div id="66" class="line hit">   66     Token dollarDollarProviderExternal = {.currency = DOLLAR, .amount = initialDollar_DollarHolder};</div><div id="67" class="line none">   67     </div><div id="68" class="line none">   68     // Define the wallets for external wallets</div><div id="69" class="line hit">   69     Token tokensAdaProviderExternal[] = {adaDollarProviderExternal, dollarAdaProviderExternal};</div><div id="70" class="line hit">   70     Wallet* walletAdaProviderExternal = <a href="setters.c.html#16">newWallet</a>(tokensAdaProviderExternal, 2);</div><div id="71" class="line hit">   71     Token tokensDollarProviderExternal[] = {adaDollarProviderExternal, dollarDollarProviderExternal};</div><div id="72" class="line hit">   72     Wallet* walletDollarProviderExternal = <a href="setters.c.html#16">newWallet</a>(tokensDollarProviderExternal, 2);</div><div id="73" class="line none">   73 </div><div id="74" class="line hit">   74     Party* dollarProvider = <a href="setters.c.html#25">newParty</a>(DOLLARPROVIDER, 1, walletDollarProviderExternal);</div><div id="75" class="line hit">   75     Party* adaProvider = <a href="setters.c.html#25">newParty</a>(ADAPROVIDER, 2, walletAdaProviderExternal);</div><div id="76" class="line none">   76 </div><div id="77" class="line none">   77 </div><div id="78" class="line none">   78     // Define the contract</div><div id="79" class="line none">   79 </div><div id="80" class="line none">   80     // Define the contract template</div><div id="81" class="line hit">   81     <a href="main.c.html#23">ContractTemplate</a> template = {</div><div id="82" class="line hit">   82         .<a href="main.c.html#19">amountAda</a> = <a href="cbmc_helper.c.html#1">constr_non_det_int</a>(0,100),</div><div id="83" class="line hit">   83         .<a href="main.c.html#20">amountDollar</a> = <a href="cbmc_helper.c.html#1">constr_non_det_int</a>(0,100),</div><div id="84" class="line hit">   84         .<a href="main.c.html#21">adaTimeout</a> = <a href="cbmc_helper.c.html#1">constr_non_det_int</a>(0,10),</div><div id="85" class="line hit">   85         .<a href="main.c.html#22">dollarTimeout</a> = <a href="cbmc_helper.c.html#1">constr_non_det_int</a>(0,10)</div><div id="86" class="line none">   86     };</div><div id="87" class="line none">   87 </div><div id="88" class="line none">   88     // Define successContract as the close contract when the swap is successful</div><div id="89" class="line hit">   89     Contract* successContract = <a href="setters.c.html#60">newContract</a>(CLOSE, (ContractParameters){</div><div id="90" class="line hit">   90     .closeParams = {</div><div id="91" class="line hit">   91         .id = 0</div><div id="92" class="line none">   92         }</div><div id="93" class="line hit">   93     }, NULL, NULL);</div><div id="94" class="line none">   94 </div><div id="95" class="line none">   95     // Define failedContract as the close contract when the swap is not successful</div><div id="96" class="line hit">   96     Contract* failedContract = <a href="setters.c.html#60">newContract</a>(CLOSE, (ContractParameters){</div><div id="97" class="line hit">   97         .closeParams = {</div><div id="98" class="line hit">   98             .id = 1</div><div id="99" class="line none">   99             }</div><div id="100" class="line hit">  100         }, NULL, NULL);</div><div id="101" class="line none">  101 </div><div id="102" class="line none">  102     // Define payAdaProvider as the part of the contract that pays the adaProvider when the swap is successful</div><div id="103" class="line hit">  103     Contract* payAdaProvider = <a href="setters.c.html#60">newContract</a>(PAY, (ContractParameters){</div><div id="104" class="line hit">  104         .payParams = {</div><div id="105" class="line hit">  105             .payer = dollarProvider,</div><div id="106" class="line hit">  106             .receiver = adaProvider,</div><div id="107" class="line hit">  107             .amount = template.<a href="main.c.html#20">amountDollar</a>,</div><div id="108" class="line hit">  108             .currency = DOLLAR</div><div id="109" class="line none">  109             }</div><div id="110" class="line hit">  110         }, NULL, successContract);</div><div id="111" class="line none">  111 </div><div id="112" class="line none">  112     // Define payDollarProvider as the part of the contract that pays the dollarProvider when the swap is successful</div><div id="113" class="line hit">  113     Contract* payDollarProvider = <a href="setters.c.html#60">newContract</a>(PAY, (ContractParameters){</div><div id="114" class="line hit">  114         .payParams = {</div><div id="115" class="line hit">  115             .payer = adaProvider,</div><div id="116" class="line hit">  116             .receiver = dollarProvider,</div><div id="117" class="line hit">  117             .amount = template.<a href="main.c.html#19">amountAda</a>,</div><div id="118" class="line hit">  118             .currency = ADA</div><div id="119" class="line none">  119             }</div><div id="120" class="line hit">  120         }, NULL, payAdaProvider);</div><div id="121" class="line none">  121 </div><div id="122" class="line none">  122     // Define whenDepositDollarProvider as the part of the contract that awaits a deposit by the dollarProvider</div><div id="123" class="line hit">  123     Contract* whenDepositDollarProvider = <a href="setters.c.html#60">newContract</a>(DEPOSIT, (ContractParameters){</div><div id="124" class="line hit">  124         .depositParams = {</div><div id="125" class="line hit">  125             .depositor = dollarProvider,</div><div id="126" class="line hit">  126             .receiver = dollarProvider,</div><div id="127" class="line hit">  127             .amount = template.<a href="main.c.html#20">amountDollar</a>,</div><div id="128" class="line hit">  128             .currency = DOLLAR,</div><div id="129" class="line hit">  129             .timeout = template.<a href="main.c.html#22">dollarTimeout</a></div><div id="130" class="line none">  130             }</div><div id="131" class="line hit">  131         }, payDollarProvider, failedContract);</div><div id="132" class="line none">  132 </div><div id="133" class="line none">  133     // Define whenDepositAdaProvider as the part of the contract that awaits a deposit by the adaProvider</div><div id="134" class="line hit">  134     Contract* whenDepositAdaProvider = <a href="setters.c.html#60">newContract</a>(DEPOSIT, (ContractParameters){</div><div id="135" class="line hit">  135         .depositParams = {</div><div id="136" class="line hit">  136             .depositor = adaProvider,</div><div id="137" class="line hit">  137             .receiver = adaProvider,</div><div id="138" class="line hit">  138             .amount = template.<a href="main.c.html#19">amountAda</a>,</div><div id="139" class="line hit">  139             .currency = ADA,</div><div id="140" class="line hit">  140             .timeout = template.<a href="main.c.html#21">adaTimeout</a></div><div id="141" class="line none">  141             }</div><div id="142" class="line hit">  142         }, whenDepositDollarProvider, failedContract);</div><div id="143" class="line none">  143 </div><div id="144" class="line none">  144     // Define the contract state</div><div id="145" class="line hit">  145     Party* parties[] = {adaProvider, dollarProvider};</div><div id="146" class="line hit">  146     ContractState* state = <a href="setters.c.html#50">newContractState</a>(whenDepositAdaProvider, internalWallet, parties, 2);</div><div id="147" class="line none">  147 </div><div id="148" class="line none">  148     // Simulation time</div><div id="149" class="line hit">  149     int currentTime = 0;</div><div id="150" class="line hit">  150     int contractTimeout = 20;</div><div id="151" class="line none">  151 </div><div id="152" class="line hit">  152     int success = -1;</div><div id="153" class="line none">  153 </div><div id="154" class="line none">  154     // THIS IS THE MAIN LOOP OF THE EXECUTION</div><div id="155" class="line none">  155     // PROBABLY NEED TO BE FACTORED OUT</div><div id="156" class="line none">  156     </div><div id="157" class="line none">  157     // Return value of the simulation</div><div id="158" class="line none">  158     // 0 means unfinished</div><div id="159" class="line none">  159     // 1 means finished with or without success</div><div id="160" class="line hit">  160     int res_ret = 0;</div><div id="161" class="line none">  161 </div><div id="162" class="line none">  162     // Get the initial ammounts of ada and dollars</div><div id="163" class="line hit">  163     int initialTotalAda = <a href="getters.c.html#26">getTotalAda</a>(state);</div><div id="164" class="line hit">  164     int initialTotalDollar = <a href="getters.c.html#39">getTotalDollars</a>(state);</div><div id="165" class="line none">  165 </div><div id="166" class="line hit">  166     while (currentTime &lt; contractTimeout &amp;&amp; res_ret == 0) {</div><div id="167" class="line none">  167         // prettyPrintWholeContractState(state, currentTime);</div><div id="168" class="line hit">  168         currentTime++;</div><div id="169" class="line none">  169 </div><div id="170" class="line hit">  170         if (state-&gt;currentContract == NULL) {</div><div id="171" class="line hit">  171             printf("End of simulation because the contract is now NULL\n");</div><div id="172" class="line hit">  172             break;</div><div id="173" class="line none">  173         }</div><div id="174" class="line none">  174 </div><div id="175" class="line hit">  175         switch (state-&gt;currentContract-&gt;type) {</div><div id="176" class="line hit">  176             case PAY: {</div><div id="177" class="line hit">  177                 Transaction transaction = <a href="payment.c.html#9">convertToTransaction</a>(&amp;(state-&gt;currentContract-&gt;params.payParams));</div><div id="178" class="line hit">  178                 int res = <a href="payment.c.html#18">makePayment</a>(state, &amp;transaction);</div><div id="179" class="line hit">  179                 if (res == 0) {</div><div id="180" class="line none">  180                 } else {</div><div id="181" class="line missed">  181                     fprintf(stderr, "PAY action was not successful\n");</div><div id="182" class="line missed">  182                     res_ret = 1;</div><div id="183" class="line none">  183                 }</div><div id="184" class="line hit">  184                 break;</div><div id="185" class="line none">  185             }</div><div id="186" class="line hit">  186             case CLOSE:</div><div id="187" class="line hit">  187                 <a href="close.c.html#8">processClose</a>(state);</div><div id="188" class="line hit">  188                 if (state-&gt;currentContract-&gt;params.closeParams.id == 0) {</div><div id="189" class="line hit">  189                     success = 1;</div><div id="190" class="line none">  190                 } else {</div><div id="191" class="line hit">  191                     success = 0;</div><div id="192" class="line none">  192                 }</div><div id="193" class="line hit">  193                 state-&gt;currentContract = state-&gt;currentContract-&gt;continueAs;</div><div id="194" class="line hit">  194                 break;</div><div id="195" class="line hit">  195             case DEPOSIT: {</div><div id="196" class="line hit">  196                 if (currentTime &gt; state-&gt;currentContract-&gt;params.depositParams.timeout){</div><div id="197" class="line hit">  197                     state-&gt;currentContract = state-&gt;currentContract-&gt;continueAs;</div><div id="198" class="line none">  198                 }</div><div id="199" class="line none">  199                 else {</div><div id="200" class="line none">  200                     // For the moment, we force the party to try to deposit whatever is asked</div><div id="201" class="line none">  201                     // TODO: Leave the choice to the simulation to do it or not</div><div id="202" class="line hit">  202                     Transaction depositTransaction = {</div><div id="203" class="line hit">  203                         .source = state-&gt;currentContract-&gt;params.depositParams.depositor,</div><div id="204" class="line hit">  204                         .destination = state-&gt;currentContract-&gt;params.depositParams.receiver,</div><div id="205" class="line hit">  205                         .amount = state-&gt;currentContract-&gt;params.depositParams.amount,</div><div id="206" class="line hit">  206                         .currency = state-&gt;currentContract-&gt;params.depositParams.currency</div><div id="207" class="line none">  207                     };</div><div id="208" class="line hit">  208                     int res = <a href="deposit.c.html#9">makeDeposit</a>(state, &amp;depositTransaction, &amp;(state-&gt;currentContract-&gt;params.depositParams));</div><div id="209" class="line none">  209                     // Handle errors</div><div id="210" class="line none">  210                     // Most of the error handling has been moved to the makeDeposit function</div><div id="211" class="line hit">  211                     if (res == 0){}else{}</div><div id="212" class="line hit">  212                 }</div><div id="213" class="line hit">  213                 break;</div><div id="214" class="line none">  214             }</div><div id="215" class="line none">  215             default:</div><div id="216" class="line missed">  216                 fprintf(stderr, "Error: Unsupported contract type\n");</div><div id="217" class="line missed">  217                 res_ret = 1;</div><div id="218" class="line none">  218         }</div><div id="219" class="line none">  219     }</div><div id="220" class="line none">  220 </div><div id="221" class="line hit">  221     int finalTotalAda = <a href="getters.c.html#26">getTotalAda</a>(state);</div><div id="222" class="line hit">  222     int finalTotalDollar = <a href="getters.c.html#39">getTotalDollars</a>(state);</div><div id="223" class="line none">  223 </div><div id="224" class="line none">  224     // Dead code check</div><div id="225" class="line none">  225     // Is expected to fail</div><div id="226" class="line none">  226     // If not, the properties are dead code and will evaluate true no matter what</div><div id="227" class="line hit">  227     int reach = 1;</div><div id="228" class="line hit">  228     __CPROVER_assert(reach == 0, "Are the properties dead-code -- needs to fail");</div><div id="229" class="line none">  229     </div><div id="230" class="line none">  230     // Test case generation examples</div><div id="231" class="line none">  231     // Can be made more complex by having more coverage criteria added in the model</div><div id="232" class="line hit">  232     __CPROVER_assert(success == 0, "Impossible to get a successful contract");</div><div id="233" class="line hit">  233     __CPROVER_assert(success == 1, "Impossible to get a failing contract");</div><div id="234" class="line none">  234 </div><div id="235" class="line none">  235     // General properties</div><div id="236" class="line none">  236     // Mainly used to show that I didn't mess up (too much) the modeling</div><div id="237" class="line hit">  237     __CPROVER_assert(initialTotalAda == finalTotalAda, "Ada are preserved!");</div><div id="238" class="line hit">  238     __CPROVER_assert(initialTotalDollar == finalTotalDollar, "Dollar are preserved!");</div><div id="239" class="line none">  239 </div><div id="240" class="line none">  240     // Marlowe assertions</div><div id="241" class="line none">  241     </div><div id="242" class="line none">  242     // Marlowe is expecte to always end on a close contract</div><div id="243" class="line none">  243     // All close contracts are expected to change success to something other than -1</div><div id="244" class="line hit">  244     __CPROVER_assert(success != -1, "Always finish on a Close contract");</div><div id="245" class="line none">  245 </div><div id="246" class="line none">  246     // Check that the internal accounts are all empty</div><div id="247" class="line hit">  247     __CPROVER_assert(adaAdaProviderInternal.amount == 0 &amp;&amp; adaDollarProviderInternal.amount == 0, "No ada left in the contract");</div><div id="248" class="line hit">  248     __CPROVER_assert(dollarAdaProviderInternal.amount == 0 &amp;&amp; dollarDollarProviderInternal.amount == 0, "No dollar left in the contract");</div><div id="249" class="line none">  249     </div><div id="250" class="line none">  250 </div><div id="251" class="line none">  251     // Functional correctness of the SWAP contract</div><div id="252" class="line none">  252 </div><div id="253" class="line none">  253     // If the contract is succesful, funds were transfered properly</div><div id="254" class="line none">  254     // If not, the funds have not been transfered but whatever was inside the contract</div><div id="255" class="line none">  255     // for some unknown reasons at the beginning, have been correctly returned</div><div id="256" class="line none">  256     // __CPROVER_assert((success != 0) || (adaAdaProviderExternal.amount == initialAda_AdaHolder + initialAda_AdaHolder_Internal - template.amountAda), "Try: Ada Provider has received back their funds and has sent away the requested ada");</div><div id="257" class="line none">  257             </div><div id="258" class="line none">  258     // switch (success){</div><div id="259" class="line none">  259     //     case 0:</div><div id="260" class="line none">  260     //         __CPROVER_assert(adaAdaProviderExternal.amount == initialAda_AdaHolder + initialAda_AdaHolder_Internal - template.amountAda, "Ada Provider has received back their funds and has sent away the requested ada");</div><div id="261" class="line none">  261     //         __CPROVER_assert(dollarAdaProviderExternal.amount == initialDollar_AdaHolder + initialDollar_AdaHolder_Internal + template.amountDollar, "Ada Provider has received back their funds and the requested dollars");</div><div id="262" class="line none">  262     //         __CPROVER_assert(adaDollarProviderExternal.amount == initialAda_DollarHolder + initialAda_DollarHolder_Internal + template.amountAda, "Dollar Provider has received back their funds and the requested ada");</div><div id="263" class="line none">  263     //         __CPROVER_assert(dollarAdaProviderExternal.amount == initialDollar_DollarHolder + initialDollar_DollarHolder_Internal - template.amountDollar, "Dollar Provider has received back their funds and sent away the requested dollars");</div><div id="264" class="line none">  264     //         break;</div><div id="265" class="line none">  265     //     case 1:</div><div id="266" class="line none">  266     //         __CPROVER_assert(adaAdaProviderExternal.amount == initialAda_AdaHolder + initialAda_AdaHolder_Internal, "Ada Provider has received back their ada funds as the contract has failed");</div><div id="267" class="line none">  267     //         __CPROVER_assert(dollarAdaProviderExternal.amount == initialDollar_AdaHolder + initialDollar_AdaHolder_Internal, "Ada Provider has received back their dollar funds as the contract has failed");</div><div id="268" class="line none">  268     //         __CPROVER_assert(adaDollarProviderExternal.amount == initialAda_DollarHolder + initialAda_DollarHolder_Internal, "Dollar Provider has received back their ada funds as the contract has failed");</div><div id="269" class="line none">  269     //         __CPROVER_assert(dollarAdaProviderExternal.amount == initialDollar_DollarHolder + initialDollar_DollarHolder_Internal, "Dollar Provider has received back their dollar funds as the contract has failed");</div><div id="270" class="line none">  270 </div><div id="271" class="line none">  271     //         break;</div><div id="272" class="line none">  272     //     default:</div><div id="273" class="line none">  273     //         __CPROVER_assert(1==0, "UNKNOWN ERROR, SUCCESS IS DIFFERENT FROM WHAT POSSIBLE");</div><div id="274" class="line none">  274     // }</div><div id="275" class="line none">  275     // Free allocated memory</div><div id="276" class="line none">  276     // TODO: Factor out the free functions</div><div id="277" class="line none">  277 </div><div id="278" class="line none">  278     // free(failedContract);</div><div id="279" class="line none">  279     // free(successContract);</div><div id="280" class="line none">  280     // free(payAdaProvider);</div><div id="281" class="line none">  281     // free(payDollarProvider);</div><div id="282" class="line none">  282     // free(whenDepositDollarProvider);</div><div id="283" class="line none">  283     // free(whenDepositAdaProvider);</div><div id="284" class="line none">  284     // free(walletAdaProviderExternal-&gt;tokens);</div><div id="285" class="line none">  285     // free(walletAdaProviderExternal);</div><div id="286" class="line none">  286     // free(walletDollarProviderExternal-&gt;tokens);</div><div id="287" class="line none">  287     // free(walletDollarProviderExternal);</div><div id="288" class="line none">  288     // free(internalWallet-&gt;accounts);</div><div id="289" class="line none">  289     // free(internalWallet);</div><div id="290" class="line none">  290     // free(walletAdaProviderInternal-&gt;tokens);</div><div id="291" class="line none">  291     // free(walletAdaProviderInternal);</div><div id="292" class="line none">  292     // free(walletDollarProviderInternal-&gt;tokens);</div><div id="293" class="line none">  293     // free(walletDollarProviderInternal);</div><div id="294" class="line none">  294     // free(adaProvider);</div><div id="295" class="line none">  295     // free(dollarProvider);</div><div id="296" class="line none">  296     // free(state-&gt;parties);</div><div id="297" class="line none">  297     // free(state);</div><div id="298" class="line none">  298 </div><div id="299" class="line hit">  299     return res_ret;</div><div id="300" class="line hit">  300 }</div>
</div>
</body>
</html>
